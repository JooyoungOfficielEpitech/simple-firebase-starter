{"version":3,"file":"typescript.js","names":["_kleur","_interopRequireDefault","require","_path","_fsExtra","_which","_crossSpawn","_del","_json","_os","obj","__esModule","default","build","source","root","output","report","options","info","kleur","blue","path","relative","del","project","tsconfig","join","fs","pathExists","config","JSON5","parse","readFile","compilerOptions","conflicts","declarationDir","push","outDir","length","warn","reduce","acc","curr","gray","yellow","e","Error","tsc","resolve","execpath","process","env","npm_execpath","cli","split","pop","includes","result","spawn","sync","stdio","encoding","cwd","stdout","trim","platform","endsWith","which","tsbuildinfo","replace","status","success","pkg","JSON","getGeneratedTypesPath","indexDTsName","basename","potentialPaths","dirname","potentialPath","fields","name","value","types","exports","some","field","Promise","all","map","typesPath","generatedTypesPath","error","toString","message"],"sources":["../../src/targets/typescript.ts"],"sourcesContent":["import kleur from 'kleur';\nimport path from 'path';\nimport fs from 'fs-extra';\nimport which from 'which';\nimport spawn from 'cross-spawn';\nimport del from 'del';\nimport JSON5 from 'json5';\nimport { platform } from 'os';\nimport type { Input } from '../types';\n\ntype Options = Input & {\n  options?: { project?: string; tsc?: string };\n};\n\nexport default async function build({\n  source,\n  root,\n  output,\n  report,\n  options,\n}: Options) {\n  report.info(\n    `Cleaning up previous build at ${kleur.blue(path.relative(root, output))}`\n  );\n\n  await del([output]);\n\n  report.info(`Generating type definitions with ${kleur.blue('tsc')}`);\n\n  const project = options?.project ? options.project : 'tsconfig.json';\n  const tsconfig = path.join(root, project);\n\n  try {\n    if (await fs.pathExists(tsconfig)) {\n      try {\n        const config = JSON5.parse(await fs.readFile(tsconfig, 'utf-8'));\n\n        if (config.compilerOptions) {\n          const conflicts: string[] = [];\n\n          if (config.compilerOptions.declarationDir) {\n            conflicts.push('compilerOptions.declarationDir');\n          }\n\n          if (\n            config.compilerOptions.outDir &&\n            path.join(root, config.compilerOptions.outDir) !== output\n          ) {\n            conflicts.push('compilerOptions.outDir');\n          }\n\n          if (conflicts.length) {\n            report.warn(\n              `Found following options in the config file which can conflict with the CLI options. Please remove them from ${kleur.blue(\n                project\n              )}:${conflicts.reduce(\n                (acc, curr) =>\n                  acc + `\\n${kleur.gray('-')} ${kleur.yellow(curr)}`,\n                ''\n              )}`\n            );\n          }\n        }\n      } catch (e) {\n        report.warn(\n          `Couldn't parse '${project}'. There might be validation errors.`\n        );\n      }\n    } else {\n      throw new Error(\n        `Couldn't find a ${kleur.blue('tsconfig.json')} in the project root.`\n      );\n    }\n\n    let tsc;\n\n    if (options?.tsc) {\n      tsc = path.resolve(root, options.tsc);\n\n      if (!(await fs.pathExists(tsc))) {\n        throw new Error(\n          `The ${kleur.blue(\n            'tsc'\n          )} binary doesn't seem to be installed at ${kleur.blue(\n            tsc\n          )}. Please specify the correct path in options or remove it to use the workspace's version.`\n        );\n      }\n    } else {\n      const execpath = process.env.npm_execpath;\n      const cli = execpath?.split('/').pop()?.includes('yarn') ? 'yarn' : 'npm';\n\n      if (cli === 'yarn') {\n        const result = spawn.sync('yarn', ['bin', 'tsc'], {\n          stdio: 'pipe',\n          encoding: 'utf-8',\n          cwd: root,\n        });\n\n        tsc = result.stdout.trim();\n      } else {\n        tsc = path.resolve(root, 'node_modules', '.bin', 'tsc');\n      }\n\n      if (platform() === 'win32' && !tsc.endsWith('.cmd')) {\n        tsc += '.cmd';\n      }\n    }\n\n    if (!(await fs.pathExists(tsc))) {\n      try {\n        tsc = await which('tsc');\n\n        if (await fs.pathExists(tsc)) {\n          report.warn(\n            `Failed to locate ${kleur.blue(\n              'tsc'\n            )} in the workspace. Falling back to the binary found in ${kleur.blue(\n              'PATH'\n            )} at ${kleur.blue(tsc)}. Consider adding ${kleur.blue(\n              'typescript'\n            )} to your ${kleur.blue(\n              'devDependencies'\n            )} or specifying the ${kleur.blue(\n              'tsc'\n            )} option for the typescript target.`\n          );\n        }\n      } catch (e) {\n        // Ignore\n      }\n    }\n\n    if (tsc == null || !(await fs.pathExists(tsc))) {\n      throw new Error(\n        `The ${kleur.blue(\n          'tsc'\n        )} binary doesn't seem to be installed under ${kleur.blue(\n          'node_modules'\n        )} or present in $PATH. Make sure you have added ${kleur.blue(\n          'typescript'\n        )} to your ${kleur.blue('devDependencies')} or specify the ${kleur.blue(\n          'tsc'\n        )} option for typescript.`\n      );\n    }\n\n    const tsbuildinfo = path.join(\n      output,\n      project.replace(/\\.json$/, '.tsbuildinfo')\n    );\n\n    try {\n      await del([tsbuildinfo]);\n    } catch (e) {\n      // Ignore\n    }\n\n    const result = spawn.sync(\n      tsc,\n      [\n        '--pretty',\n        '--declaration',\n        '--declarationMap',\n        '--noEmit',\n        'false',\n        '--emitDeclarationOnly',\n        '--project',\n        project,\n        '--outDir',\n        output,\n      ],\n      {\n        stdio: 'inherit',\n        cwd: root,\n      }\n    );\n\n    if (result.status === 0) {\n      await del([tsbuildinfo]);\n\n      report.success(\n        `Wrote definition files to ${kleur.blue(path.relative(root, output))}`\n      );\n\n      const pkg = JSON.parse(\n        await fs.readFile(path.join(root, 'package.json'), 'utf-8')\n      );\n\n      const getGeneratedTypesPath = async () => {\n        if (pkg.source) {\n          const indexDTsName =\n            path.basename(pkg.source).replace(/\\.(jsx?|tsx?)$/, '') + '.d.ts';\n\n          const potentialPaths = [\n            path.join(output, path.dirname(pkg.source), indexDTsName),\n            path.join(\n              output,\n              path.dirname(path.relative(source, path.join(root, pkg.source))),\n              indexDTsName\n            ),\n          ];\n\n          for (const potentialPath of potentialPaths) {\n            if (await fs.pathExists(potentialPath)) {\n              return path.relative(root, potentialPath);\n            }\n          }\n        }\n\n        return null;\n      };\n\n      const fields = [\n        { name: 'types', value: pkg.types },\n        { name: \"exports['.'].types\", value: pkg.exports?.['.']?.types },\n      ];\n\n      if (fields.some((field) => field.value)) {\n        await Promise.all(\n          fields.map(async ({ name, value }) => {\n            if (!value) {\n              return;\n            }\n\n            const typesPath = path.join(root, value);\n\n            if (!(await fs.pathExists(typesPath))) {\n              const generatedTypesPath = await getGeneratedTypesPath();\n\n              if (!generatedTypesPath) {\n                report.warn(\n                  `Failed to detect the entry point for the generated types. Make sure you have a valid ${kleur.blue(\n                    'source'\n                  )} field in your ${kleur.blue('package.json')}.`\n                );\n              }\n\n              report.error(\n                `The ${kleur.blue(name)} field in ${kleur.blue(\n                  'package.json'\n                )} points to a non-existent file: ${kleur.blue(\n                  value\n                )}.\\nVerify the path points to the correct file under ${kleur.blue(\n                  path.relative(root, output)\n                )}${\n                  generatedTypesPath\n                    ? ` (found ${kleur.blue(generatedTypesPath)}).`\n                    : '.'\n                }`\n              );\n\n              throw new Error(`Found incorrect path in '${name}' field.`);\n            }\n          })\n        );\n      } else {\n        const generatedTypesPath = await getGeneratedTypesPath();\n\n        report.warn(\n          `No ${kleur.blue(\n            fields.map((field) => field.name).join(' or ')\n          )} field found in ${kleur.blue('package.json')}.\\nConsider ${\n            generatedTypesPath\n              ? `pointing it to ${kleur.blue(generatedTypesPath)}`\n              : 'adding it'\n          } so that consumers of your package can use the types.`\n        );\n      }\n    } else {\n      throw new Error('Failed to build definition files.');\n    }\n  } catch (e: unknown) {\n    if (e != null && typeof e === 'object') {\n      if ('stdout' in e && e.stdout != null) {\n        report.error(\n          `Errors found when building definition files:\\n${e.stdout.toString()}`\n        );\n      } else if ('message' in e && typeof e.message === 'string') {\n        report.error(e.message);\n      } else {\n        throw e;\n      }\n    } else {\n      throw e;\n    }\n\n    throw new Error('Failed to build definition files.');\n  }\n}\n"],"mappings":"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"}