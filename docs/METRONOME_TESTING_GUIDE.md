# 메트로놈 기능 테스트 가이드

**작성일**: 2025-11-04
**Phase**: 1 (기본 구현)

---

## 📱 테스트 준비

### 1. 앱 실행
```bash
# 개발 서버 시작
npm start

# iOS 시뮬레이터
npm run ios

# Android 에뮬레이터
npm run android
```

### 2. MusicPlayer 화면 접근
- 앱 실행 후 MusicPlayer 탭/화면으로 이동
- 메트로놈 컨트롤 섹션 확인

---

## ✅ 기능 테스트 체크리스트

### 1. 초기화 테스트
- [ ] 메트로놈 컨트롤이 화면에 표시됨
- [ ] 초기 상태: OFF, 120 BPM, 70% 볼륨
- [ ] "로딩 중..." 표시 후 사라짐
- [ ] 에러 없이 준비 완료

**예상 로그**:
```
🎵 메트로놈 사운드 로드 시작...
✅ 메트로놈 사운드 파일 로드 완료
✅ 메트로놈 준비 완료
```

---

### 2. ON/OFF 토글 테스트
- [ ] OFF 버튼 클릭 시 ON으로 변경
- [ ] 버튼 색상: 회색(OFF) → 녹색(ON)
- [ ] ON 상태에서 박자 인디케이터 표시
- [ ] 메트로놈 사운드 재생 시작

**확인 방법**:
1. OFF 버튼 터치
2. 버튼이 녹색으로 변경되는지 확인
3. 비프음이 들리는지 확인
4. 박자 인디케이터가 움직이는지 확인

**예상 로그**:
```
🎵 메트로놈 시작 - BPM: 120, Interval: 500.00ms
```

---

### 3. BPM 조절 테스트

#### 테스트 케이스 1: 최소값 (40 BPM)
- [ ] BPM 슬라이더를 왼쪽 끝으로 이동
- [ ] "40 BPM" 표시 확인
- [ ] 느린 비프음 재생 (1500ms 간격)

#### 테스트 케이스 2: 기본값 (120 BPM)
- [ ] 중간 위치
- [ ] "120 BPM" 표시
- [ ] 보통 속도 비프음 (500ms 간격)

#### 테스트 케이스 3: 최대값 (240 BPM)
- [ ] BPM 슬라이더를 오른쪽 끝으로 이동
- [ ] "240 BPM" 표시
- [ ] 빠른 비프음 재생 (250ms 간격)

#### 테스트 케이스 4: 실시간 변경
- [ ] 메트로놈 ON 상태에서 BPM 조절
- [ ] 즉시 타이밍 변경 확인
- [ ] 부드러운 전환

**확인 방법**:
1. 메트로놈 ON
2. BPM 슬라이더 조절
3. 비프음 간격이 즉시 변경되는지 확인
4. 숫자 표시가 정확한지 확인

---

### 4. 볼륨 조절 테스트

#### 테스트 케이스 1: 최소값 (0%)
- [ ] 볼륨 슬라이더를 왼쪽 끝으로
- [ ] "0%" 표시
- [ ] 무음 (소리 안 들림)
- [ ] 박자 인디케이터는 계속 동작

#### 테스트 케이스 2: 중간값 (50%)
- [ ] 중간 위치
- [ ] "50%" 표시
- [ ] 중간 크기 사운드

#### 테스트 케이스 3: 최대값 (100%)
- [ ] 볼륨 슬라이더를 오른쪽 끝으로
- [ ] "100%" 표시
- [ ] 최대 크기 사운드

#### 테스트 케이스 4: 실시간 변경
- [ ] 메트로놈 ON 상태에서 볼륨 조절
- [ ] 즉시 볼륨 변경 확인

**확인 방법**:
1. 메트로놈 ON
2. 볼륨 슬라이더 조절
3. 사운드 크기가 즉시 변경되는지 확인
4. 퍼센트 표시가 정확한지 확인

---

### 5. 박자 인디케이터 테스트

#### 시각적 확인
- [ ] 4개의 원형 인디케이터 표시
- [ ] 첫 번째 원에 빨간색 테두리 (강박 표시)
- [ ] 현재 박자가 파란색으로 강조
- [ ] 1.3배 확대 효과
- [ ] 그림자 효과

#### 동기화 확인
- [ ] 비프음과 시각적 표시 동기화
- [ ] 강박(첫 박)에서 고음 비프 + 빨간 테두리
- [ ] 약박에서 저음 비프 + 일반 원

**확인 방법**:
1. 메트로놈 ON (120 BPM)
2. 박자 인디케이터 관찰
3. 비프음과 시각적 표시가 일치하는지 확인
4. 첫 박에서 고음과 빨간 테두리 확인

---

### 6. 에러 처리 테스트

#### 사운드 파일 없는 경우
**테스트 방법**:
```bash
# 사운드 파일 임시 이동
mv app/assets/sounds/metronome-high.wav /tmp/
mv app/assets/sounds/metronome-low.wav /tmp/

# 앱 재시작
npm start
```

**예상 동작**:
- [ ] "⚠️ 무음 모드" 표시
- [ ] 박자 인디케이터는 정상 동작
- [ ] 사운드는 재생 안 됨
- [ ] 에러 메시지: "사운드 파일이 없어도 박자는 시각적으로 표시됩니다"

**복구**:
```bash
# 사운드 파일 복원
mv /tmp/metronome-high.wav app/assets/sounds/
mv /tmp/metronome-low.wav app/assets/sounds/

# 또는 재생성
node scripts/generate-metronome-sounds.js
```

---

### 7. 타이밍 정확도 테스트

#### 콘솔 로그 확인
1. 메트로놈 ON (120 BPM)
2. 콘솔에서 타이밍 로그 관찰
3. 500ms 간격 확인

**예상 로그**:
```
🎵 메트로놈 시작 - BPM: 120, Interval: 500.00ms
[500ms 간격으로 반복]
```

#### 수동 타이밍 테스트
1. 스톱워치 준비
2. 메트로놈 ON (120 BPM)
3. 10초간 박자 세기
4. 20회 박자 = 정확함 (±1회 허용)

---

### 8. 통합 테스트 (A-B 루프와 함께)

#### 시나리오 1: 메트로놈 + 음악 재생
1. 음악 재생 시작
2. 메트로놈 ON
3. 두 오디오가 동시에 재생되는지 확인

**예상 동작**:
- [ ] 음악과 메트로놈 믹싱 재생
- [ ] 오디오 간섭 없음
- [ ] 볼륨 독립적 조절 가능

#### 시나리오 2: 메트로놈 + A-B 루프
1. A-B 루프 설정 (예: 10초-20초)
2. 루프 활성화
3. 메트로놈 ON

**예상 동작**:
- [ ] 루프 재생 중 메트로놈 동작
- [ ] 루프 재시작 시 메트로놈 계속 동작
- [ ] 박자 카운트는 루프와 독립적

#### 시나리오 3: 메트로놈 + 일시정지
1. 메트로놈 ON
2. 음악 일시정지
3. 음악 재생

**예상 동작**:
- [ ] 일시정지 중에도 메트로놈 계속 동작
- [ ] 재생 시작 시 메트로놈 영향 없음

---

### 9. 성능 테스트

#### 메모리 사용량
1. 메트로놈 OFF → ON 반복 10회
2. 메모리 누수 확인

**확인 방법**:
- React DevTools 프로파일러
- 메모리 사용량 증가 없음

#### CPU 사용량
1. 메트로놈 ON (240 BPM)
2. CPU 사용량 모니터링

**예상**:
- 낮은 CPU 사용량 (<5%)
- 발열 없음

---

### 10. 플랫폼별 테스트

#### iOS
- [ ] 사운드 재생 정상
- [ ] 볼륨 조절 정상
- [ ] 백그라운드 동작 확인
- [ ] 무음 모드에서도 재생 (playsInSilentModeIOS: true)

#### Android
- [ ] 사운드 재생 정상
- [ ] 볼륨 조절 정상
- [ ] 믹싱 동작 확인 (shouldDuckAndroid: true)

---

## 🐛 알려진 이슈

### 1. 타이밍 오차
**현상**: ±10ms 오차 발생 가능
**원인**: `setInterval` 정확도 한계
**영향**: 대부분의 경우 무시 가능
**해결 예정**: Phase 2에서 Web Audio API 검토

### 2. 안드로이드 사운드 지연
**현상**: 첫 비프음 지연 가능
**원인**: expo-av 초기화 시간
**해결방법**: 사운드 프리로딩 구현 검토

---

## 📊 테스트 결과 기록

### 테스트 환경
- **날짜**: ________
- **플랫폼**: iOS / Android / Web
- **디바이스**: ________
- **앱 버전**: ________

### 결과
- [ ] 모든 테스트 통과
- [ ] 일부 이슈 발견 (아래 기록)
- [ ] 치명적 버그 발견

### 발견된 이슈
1. ________________________________________
2. ________________________________________
3. ________________________________________

---

## 🔧 문제 해결

### 사운드가 재생되지 않음
1. 볼륨 확인 (0%가 아닌지)
2. 디바이스 볼륨 확인
3. 콘솔 로그 확인
4. 사운드 파일 존재 확인: `ls app/assets/sounds/`

### 타이밍이 부정확함
1. BPM 값 확인
2. 콘솔 로그로 interval 확인
3. 디바이스 성능 확인 (낮은 사양에서 지연 가능)

### 박자 인디케이터가 안 보임
1. 메트로놈이 ON 상태인지 확인
2. 화면 스크롤 확인
3. React DevTools로 컴포넌트 렌더링 확인

---

## ✅ 최종 체크리스트

- [ ] 초기화 테스트 완료
- [ ] ON/OFF 토글 테스트 완료
- [ ] BPM 조절 테스트 완료
- [ ] 볼륨 조절 테스트 완료
- [ ] 박자 인디케이터 테스트 완료
- [ ] 에러 처리 테스트 완료
- [ ] 타이밍 정확도 테스트 완료
- [ ] 통합 테스트 완료
- [ ] 성능 테스트 완료
- [ ] 플랫폼별 테스트 완료

---

**테스트 완료일**: ________
**테스터**: ________
**승인**: ________
